---
title: "Two-Factor Authentication"
description: "Endpoints for setting up, validating, and resetting 2FA on user accounts"
---

## Create 2FA Setup

<Card title="GET /user/2FA/create" icon="shield-halved">
  Generates a new 2FA secret and QR code URL for the user to scan with an authenticator app (e.g. Google Authenticator).
</Card>

```
GET /user/2FA/create
```

**Authentication:** `connected`

**Response**

```json
{
  "status": "success",
  "data": {
    "qrCode": "https://chart.googleapis.com/chart?chs=200x200&cht=qr&chl=otpauth://...",
    "base32": "JBSWY3DPEHPK3PXP",
    "key": "randomstring"
  }
}
```

| Field | Type | Description |
|-------|------|-------------|
| `qrCode` | string | URL of the QR code image to scan with an authenticator app |
| `base32` | string | Base32-encoded secret key (for manual entry) |
| `key` | string | Random key component used for secret generation |

<Note>
  Save the `key` and `base32` values â€” they are needed to validate and activate 2FA in the next step.
</Note>

---

## Validate & Activate 2FA

<Card title="POST /user/2FA/validate" icon="check-double">
  Validates a TOTP code against the generated secret and activates 2FA on the account. Requires a backup email address.
</Card>

```
POST /user/2FA/validate
```

**Authentication:** `connected`

**Body Parameters**

<ParamField body="secret" type="string" required>
  The `key` value returned from the create 2FA endpoint.
</ParamField>

<ParamField body="code" type="string" required>
  The 6-digit TOTP code from the authenticator app.
</ParamField>

<ParamField body="email" type="string" required>
  Backup email address for 2FA recovery.
</ParamField>

**Response**

```json
{
  "status": "success",
  "data": "2FA activated"
}
```

**Errors**

| Status | Message |
|--------|---------|
| `error` | Invalid email |
| `error` | Invalid code |
| `error` | Missing post parameters |

---

## Request 2FA Reset

<Card title="POST /user/reset2FA/ask" icon="rotate-left">
  Sends a 2FA reset code to the user's backup email address. This is the first step of the 2FA reset process.
</Card>

```
POST /user/reset2FA/ask
```

**Authentication:** `connected`

**Response**

```json
{
  "status": "success",
  "data": "Reset code sent to email"
}
```

**Errors**

| Status | Message |
|--------|---------|
| `error` | 2FA is not activated |
| `error` | No 2FA email found for this user |
| `error` | Failed to send email |

<Warning>
  The reset code is sent to the backup email that was provided during 2FA activation.
</Warning>

---

## Validate 2FA Reset

<Card title="POST /user/reset2FA/validate" icon="unlock">
  Validates the 2FA reset code received by email and removes 2FA from the account.
</Card>

```
POST /user/reset2FA/validate
```

**Authentication:** `connected`

**Body Parameters**

<ParamField body="code" type="string" required>
  The 6-digit reset code sent to the backup email. Can also be an array of individual digits.
</ParamField>

**Response**

```json
{
  "status": "success",
  "data": "2FA has been removed"
}
```

**Errors**

| Status | Message |
|--------|---------|
| `error` | 2FA is not activated |
| `error` | Invalid reset code |
| `error` | Failed to remove 2FA |
| `error` | Missing code parameter |
